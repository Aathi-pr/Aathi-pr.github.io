        // ====================================
// GSAP INITIALIZATION
// ====================================
gsap.registerPlugin(ScrollTrigger, ScrollToPlugin);

// ====================================
// CUSTOM CURSOR - DESKTOP ONLY - SMOOTH & OPTIMIZED
// ====================================
if (window.innerWidth > 1024) {
    const cursor = document.querySelector('.cursor');
    const cursorDot = document.querySelector('.cursor-dot');
    
    let mouseX = 0;
    let mouseY = 0;
    let cursorX = 0;
    let cursorY = 0;
    let dotX = 0;
    let dotY = 0;

    document.addEventListener('mousemove', (e) => {
        mouseX = e.clientX;
        mouseY = e.clientY;
    });

    gsap.ticker.add(() => {
        const speed = 0.2;
        const dotSpeed = 0.5;
        
        cursorX += (mouseX - cursorX) * speed;
        cursorY += (mouseY - cursorY) * speed;
        
        dotX += (mouseX - dotX) * dotSpeed;
        dotY += (mouseY - dotY) * dotSpeed;
        
        cursor.style.transform = `translate(${cursorX}px, ${cursorY}px) translate(-50%, -50%)`;
        cursorDot.style.transform = `translate(${dotX}px, ${dotY}px) translate(-50%, -50%)`;
    });

    const interactiveElements = document.querySelectorAll('a, button, .project-card, .skill-item, .badge, .social-icon, .theme-switcher, .menu-toggle, .nav-link');
    interactiveElements.forEach(el => {
        el.addEventListener('mouseenter', () => {
            gsap.to(cursor, {
                scale: 1.5,
                duration: 0.3,
                ease: 'power2.out'
            });
        });
        el.addEventListener('mouseleave', () => {
            gsap.to(cursor, {
                scale: 1,
                duration: 0.3,
                ease: 'power2.out'
            });
        });
    });
}

// ====================================
// FULLSCREEN NAVIGATION - MOBILE/TABLET ONLY
// ====================================
const fullscreenNav = document.querySelector('.fullscreen-nav');
const menuToggle = document.querySelector('.menu-toggle');
const navClose = document.querySelector('.nav-close');
const fullscreenNavLinks = document.querySelectorAll('.fullscreen-nav-link');
let isNavOpen = false;

if (window.innerWidth <= 1024) {
    const navTimeline = gsap.timeline({ paused: true });

    navTimeline
        .to(fullscreenNav, {
            opacity: 1,
            visibility: 'visible',
            duration: 0,
        })
        .from('.fullscreen-nav-item', {
            y: 100,
            opacity: 0,
            stagger: 0.1,
            duration: 0.8,
            ease: 'power3.out'
        })
        .from(navClose, {
            opacity: 0,
            rotation: -90,
            duration: 0.5,
            ease: 'back.out(2)'
        }, '-=0.5');

    menuToggle.addEventListener('click', () => {
        isNavOpen = !isNavOpen;
        if (isNavOpen) {
            navTimeline.play();
        } else {
            navTimeline.reverse();
        }
    });

    navClose.addEventListener('click', () => {
        isNavOpen = false;
        navTimeline.reverse();
    });

    fullscreenNavLinks.forEach(link => {
        link.addEventListener('click', (e) => {
            e.preventDefault();
            const targetId = link.getAttribute('href');
            const targetSection = document.querySelector(targetId);
            
            isNavOpen = false;
            navTimeline.reverse();
            
            setTimeout(() => {
                if (targetSection) {
                    gsap.to(window, {
                        scrollTo: {
                            y: targetSection,
                            offsetY: 80
                        },
                        duration: 1.5,
                        ease: 'power3.inOut'
                    });
                }
            }, 500);
        });
    });
}

// ====================================
// DESKTOP NAVIGATION - SMOOTH SCROLL
// ====================================
const navLinks = document.querySelectorAll('.nav-link');
navLinks.forEach(link => {
    link.addEventListener('click', (e) => {
        e.preventDefault();
        const targetId = link.getAttribute('href');
        const targetSection = document.querySelector(targetId);
        
        if (targetSection) {
            gsap.to(window, {
                scrollTo: {
                    y: targetSection,
                    offsetY: 80
                },
                duration: 1.5,
                ease: 'power3.inOut'
            });
        }
    });
});

// ====================================
// NAVIGATION SCROLL EFFECT
// ====================================
const navContainer = document.querySelector('.nav-container');

window.addEventListener('scroll', () => {
    if (window.scrollY > 100) {
        navContainer.classList.add('scrolled');
    } else {
        navContainer.classList.remove('scrolled');
    }
});

// ====================================
// THEME SWITCHER
// ====================================
const themeSwitcher = document.querySelector('.theme-switcher');
const themeToggle = document.querySelector('.theme-toggle');
let currentTheme = 'light';

themeSwitcher.addEventListener('click', () => {
    currentTheme = currentTheme === 'light' ? 'dark' : 'light';
    document.documentElement.setAttribute('data-theme', currentTheme);
    themeSwitcher.setAttribute('data-theme', currentTheme);

    gsap.to(themeToggle, {
        x: currentTheme === 'dark' ? 28 : 0,
        duration: 0.3,
        ease: 'power2.out'
    });
});

// ====================================
// HERO ANIMATIONS
// ====================================
Splitting();

gsap.from('.hero-name h1:first-child .char', {
    opacity: 0,
    y: 100,
    rotateX: -90,
    stagger: 0.02,
    duration: 1,
    ease: 'back.out(1.7)',
    delay: 0.3
});

gsap.from('.hero-name h1:last-child .char', {
    opacity: 0,
    y: 100,
    rotateX: -90,
    stagger: 0.02,
    duration: 1,
    ease: 'back.out(1.7)',
    delay: 0.5
});

gsap.to('.decorative-line', {
    width: '200px',
    duration: 1,
    ease: 'power2.out',
    delay: 1.2
});

gsap.to('.hero-tagline', {
    opacity: 1,
    y: 0,
    duration: 0.8,
    ease: 'power2.out',
    delay: 1.5
});

gsap.to('.skill-badges', {
    opacity: 1,
    y: 0,
    duration: 0.8,
    ease: 'power2.out',
    delay: 1.7
});

gsap.to('.cta-buttons', {
    opacity: 1,
    y: 0,
    duration: 0.8,
    ease: 'power2.out',
    delay: 1.9
});

// Desktop stats and social icons
if (window.innerWidth > 1024) {
    gsap.to('.availability-badge.desktop-only', {
        opacity: 1,
        y: 0,
        duration: 0.8,
        ease: 'power2.out',
        delay: 2
    });

    gsap.to('.social-icons.left', {
        opacity: 1,
        x: 0,
        duration: 0.8,
        ease: 'power2.out',
        delay: 2
    });

    gsap.to('.social-icons.right', {
        opacity: 1,
        x: 0,
        duration: 0.8,
        ease: 'power2.out',
        delay: 2
    });

    gsap.from('.statistics.left .stat', {
        opacity: 0,
        x: -50,
        duration: 0.8,
        stagger: 0.2,
        ease: 'power2.out',
        delay: 2.2
    });

    gsap.from('.statistics.right .stat', {
        opacity: 0,
        x: 50,
        duration: 0.8,
        stagger: 0.2,
        ease: 'power2.out',
        delay: 2.2
    });

    gsap.to('.scroll-indicator', {
        opacity: 1,
        duration: 0.8,
        ease: 'power2.out',
        delay: 2.5
    });
}

// ====================================
// PROJECTS SECTION - ENHANCED MOBILE ANIMATIONS
// ====================================
gsap.to('.projects-section-title', {
    scrollTrigger: {
        trigger: '.projects-section',
        start: 'top 60%',
        toggleActions: 'play none none reverse'
    },
    opacity: 1,
    y: 0,
    duration: 1,
    ease: 'power3.out'
});

if (window.innerWidth > 768) {
    // Desktop horizontal scroll
    const projectsScroll = document.querySelector('.projects-scroll');
    const projectsContainer = document.querySelector('.projects-scroll-container');
    
    if (projectsScroll) {
        gsap.set('.project-card', { opacity: 1, x: 0 });

        gsap.from('.project-card', {
            opacity: 0,
            y: 50,
            stagger: 0.2,
            scrollTrigger: {
                trigger: '.projects-horizontal-wrapper',
                start: 'top 60%',
                end: 'top 20%',
                scrub: 1
            }
        });

        gsap.to(projectsScroll, {
            x: () => -(projectsScroll.scrollWidth - window.innerWidth + 200),
            ease: 'none',
            scrollTrigger: {
                trigger: '.projects-horizontal-wrapper',
                start: 'top top',
                end: 'bottom bottom',
                scrub: 1,
                pin: projectsContainer,
                anticipatePin: 1,
                invalidateOnRefresh: true
            }
        });
    }
} else {
    // MOBILE: Enhanced individual card animations
    gsap.set('.project-card', { x: 0 });
    
    gsap.utils.toArray('.project-card').forEach((card, index) => {
        // Main card animation
        gsap.fromTo(card,
            {
                opacity: 0,
                y: 80,
                scale: 0.95
            },
            {
                opacity: 1,
                y: 0,
                scale: 1,
                duration: 1,
                ease: 'power3.out',
                scrollTrigger: {
                    trigger: card,
                    start: 'top 85%',
                    end: 'top 40%',
                    toggleActions: 'play none none reverse',
                    markers: false
                }
            }
        );
        
        // Stagger animation for card content
        gsap.fromTo(card.querySelectorAll('.project-image, .project-title, .project-desc, .project-actions'),
            {
                opacity: 0,
                y: 30
            },
            {
                opacity: 1,
                y: 0,
                duration: 0.6,
                stagger: 0.15,
                ease: 'power2.out',
                scrollTrigger: {
                    trigger: card,
                    start: 'top 80%',
                    toggleActions: 'play none none reverse'
                }
            }
        );
    });
}

// ====================================
// ABOUT SECTION
// ====================================
gsap.to('.about-section .section-title', {
    scrollTrigger: {
        trigger: '.about-section',
        start: 'top 60%',
        toggleActions: 'play none none reverse'
    },
    opacity: 1,
    y: 0,
    duration: 1,
    ease: 'power3.out'
});

gsap.to('.about-photo-frame', {
    scrollTrigger: {
        trigger: '.about-content',
        start: 'top 60%',
        toggleActions: 'play none none reverse'
    },
    opacity: 1,
    x: 0,
    duration: 1,
    ease: 'power3.out'
});

gsap.to('.about-paragraph', {
    scrollTrigger: {
        trigger: '.about-text',
        start: 'top 60%',
        toggleActions: 'play none none reverse'
    },
    opacity: 1,
    x: 0,
    duration: 0.8,
    stagger: 0.2,
    ease: 'power3.out'
});

// ====================================
// COLLABORATE SECTION - PROPERLY FIXED
// ====================================
const collaborateSection = document.querySelector('.collaborate-section');
const collaborateScroll = document.querySelector('.collaborate-scroll');

if (window.innerWidth > 768) {
    // DESKTOP
    const collaborateTimeline = gsap.timeline({
        scrollTrigger: {
            trigger: collaborateSection,
            start: 'top top',
            end: '+=200%',
            scrub: 1,
            pin: true,
            pinSpacing: true
        }
    });

    collaborateTimeline.to(collaborateScroll, { x: '-50%', ease: 'none' }, 0);
    
    document.querySelectorAll('.collaborate-text-fill').forEach(fill => {
        collaborateTimeline.to(fill, { width: '100%', ease: 'none' }, 0);
    });
} else {
    // MOBILE - COMPLETE FIX
    
    // Remove duplicate text
    const texts = document.querySelectorAll('.collaborate-text');
    if (texts[1]) texts[1].remove();
    
    const fill = document.querySelector('.collaborate-text-fill');
    
    if (fill) {
        // Set initial state
        gsap.set(fill, { width: '0%', display: 'block', visibility: 'visible' });
        
        // Create single timeline for synchronization
        const mobileTimeline = gsap.timeline({
            scrollTrigger: {
                trigger: collaborateSection,
                start: 'top top',
                end: '+=400%', // Longer pin duration
                scrub: 1,
                pin: true,
                pinSpacing: true,
                anticipatePin: 1
            }
        });
        
        // Add horizontal scroll - scroll MORE to show full text
        mobileTimeline.to(collaborateScroll, {
            x: () => {
                const scrollWidth = collaborateScroll.scrollWidth;
                const viewportWidth = window.innerWidth;
                // Ensure full text is visible
                return -(scrollWidth - viewportWidth + 200);
            },
            ease: 'none',
            duration: 1
        }, 0);
        
        // Add fill animation synchronized with scroll
        mobileTimeline.to(fill, {
            width: '100%',
            ease: 'none',
            duration: 1
        }, 0);
    }
}


// ====================================
// SKILLS SECTION
// ====================================
gsap.to('.skills-tagline', {
    scrollTrigger: {
        trigger: '.skills-section',
        start: 'top 60%',
        toggleActions: 'play none none reverse'
    },
    opacity: 1,
    y: 0,
    duration: 0.8,
    ease: 'power3.out'
});

gsap.to('.skills-section .section-title', {
    scrollTrigger: {
        trigger: '.skills-section',
        start: 'top 60%',
        toggleActions: 'play none none reverse'
    },
    opacity: 1,
    y: 0,
    duration: 1,
    ease: 'power3.out'
});

gsap.to('.skills-description', {
    scrollTrigger: {
        trigger: '.skills-section',
        start: 'top 60%',
        toggleActions: 'play none none reverse'
    },
    opacity: 1,
    y: 0,
    duration: 0.8,
    ease: 'power3.out'
});

gsap.to('.skill-item', {
    scrollTrigger: {
        trigger: '.skills-grid',
        start: 'top 60%',
        toggleActions: 'play none none reverse'
    },
    opacity: 1,
    y: 0,
    duration: 0.8,
    stagger: 0.08,
    ease: 'back.out(1.2)'
});

document.querySelectorAll('.skill-item').forEach(item => {
    const bar = item.querySelector('.skill-bar');
    if (bar) {
        const level = bar.getAttribute('data-level');
        item.style.setProperty('--skill-width', level + '%');
    }
});

gsap.to('.skills-legend', {
    scrollTrigger: {
        trigger: '.skills-legend',
        start: 'top 70%',
        toggleActions: 'play none none reverse'
    },
    opacity: 1,
    y: 0,
    duration: 1,
    ease: 'power3.out'
});

gsap.from('.legend-item', {
    scrollTrigger: {
        trigger: '.skills-legend',
        start: 'top 70%',
        toggleActions: 'play none none reverse'
    },
    scale: 0,
    duration: 0.6,
    stagger: 0.1,
    ease: 'back.out(2)'
});

gsap.to('.skill-item[data-highlight="true"] .skill-icon', {
    rotation: 360,
    duration: 20,
    repeat: -1,
    ease: 'none'
});

// ====================================
// TIMELINE SECTION - ENHANCED ANIMATIONS
// ====================================
gsap.to('.timeline-section .section-title', {
    scrollTrigger: {
        trigger: '.timeline-section',
        start: 'top 60%',
        toggleActions: 'play none none reverse'
    },
    opacity: 1,
    y: 0,
    duration: 1,
    ease: 'power3.out'
});

gsap.utils.toArray('.timeline-item').forEach((item, index) => {
    const dot = item.querySelector('.timeline-dot');
    const content = item.querySelector('.timeline-content');
    
    // Enhanced timeline item animation
    gsap.fromTo(item,
        {
            opacity: 0,
            x: index % 2 === 0 ? -100 : 100
        },
        {
            opacity: 1,
            x: 0,
            duration: 1,
            ease: 'power3.out',
            scrollTrigger: {
                trigger: item,
                start: 'top 75%',
                toggleActions: 'play none none reverse'
            }
        }
    );
    
    // Content slide in
    gsap.fromTo(content,
        {
            y: 30,
            opacity: 0
        },
        {
            y: 0,
            opacity: 1,
            duration: 0.8,
            ease: 'power2.out',
            scrollTrigger: {
                trigger: item,
                start: 'top 70%',
                toggleActions: 'play none none reverse'
            },
            delay: 0.2
        }
    );
    
    // Dot scale animation
    gsap.fromTo(dot,
        {
            scale: 0,
            opacity: 0
        },
        {
            scale: 1,
            opacity: 1,
            duration: 0.5,
            ease: 'back.out(2)',
            scrollTrigger: {
                trigger: item,
                start: 'top 70%',
                toggleActions: 'play none none reverse'
            },
            delay: 0.4
        }
    );
    
    // Additional content stagger for mobile
    if (window.innerWidth <= 768) {
        gsap.fromTo(item.querySelectorAll('.timeline-date, .timeline-title, .timeline-subtitle, .timeline-desc'),
            {
                opacity: 0,
                y: 20
            },
            {
                opacity: 1,
                y: 0,
                duration: 0.5,
                stagger: 0.1,
                ease: 'power2.out',
                scrollTrigger: {
                    trigger: item,
                    start: 'top 70%',
                    toggleActions: 'play none none reverse'
                },
                delay: 0.5
            }
        );
    }
});

// ====================================
// CONTACT SECTION
// ====================================
gsap.to('.contact-section .section-title', {
    scrollTrigger: {
        trigger: '.contact-section',
        start: 'top 60%',
        toggleActions: 'play none none reverse'
    },
    opacity: 1,
    y: 0,
    duration: 1,
    ease: 'power3.out'
});

gsap.to('.contact-form', {
    scrollTrigger: {
        trigger: '.contact-form',
        start: 'top 60%',
        toggleActions: 'play none none reverse'
    },
    opacity: 1,
    y: 0,
    duration: 1,
    ease: 'power3.out'
});

// ====================================
// FORM SUBMISSION
// ====================================
const contactForm = document.querySelector('.contact-form');


// ====================================
// REFRESH SCROLLTRIGGER
// ====================================
let resizeTimer;
window.addEventListener('resize', () => {
    clearTimeout(resizeTimer);
    resizeTimer = setTimeout(() => {
        ScrollTrigger.refresh();
    }, 250);
});

window.addEventListener('load', () => {
    ScrollTrigger.refresh();
});